
# 联立方程模型

## 举例:**牛奶市场的供求模型**

假设牛奶市场的供给量 $Q_s$ 和需求量 $Q_d$ 分别由以下方程决定：

1. **牛奶供给模型**：
$$Q_s = \alpha_0 + \alpha_1 P + \alpha_2 X + \epsilon_1$$
其中：

• $Q_s$ 是牛奶的供给量。
• $P$ 是牛奶的价格。
• $X$ 是影响供给的其他因素。
• $\epsilon_1$ 是影响供给的随机因素。

2. **牛奶需求模型**：
$$Q_d = \beta_0 + \beta_1 P + \beta_2 Z + \epsilon_2$$
其中：

• $Q_d$ 是牛奶的需求量。
• $P$ 是牛奶的价格。
• $Z$ 是影响需求的其他因素。
• $\epsilon_2$ 是影响需求的随机因素。

3. **市场均衡条件**：
$$Q_s = Q_d$$
即供给量等于需求量，市场达到均衡。

## **内生性问题的产生**

供给和需求不可知,只能看到交易量,而且Q和P同时决定,由供给和需求曲线的检点决定.没发控制一个变另一个.所以要研究二者之一,另一个一定内生.出现联立性偏误.

哪怕两个方程往里带入,是可以消除内生性变量,可以估计了,但是算出来的东西不反映经济学关系.反映外生变量最终影响解释变量的程度.这样的方程是个简约方程.原来的方程组叫做结构方程.结构方程可以直接量化经济传导关系,但是不可识别.

==如果一个变量的变化经过方程系统的传导后又影响了它本身,那么这个变量就是内生变量==

在上述模型中，价格 $P$ 既出现在供给方程中，也出现在需求方程中。价格 $P$ 同时受到供给
和需求的影响，是一个内生变量。内生性问题的产生原因如下：

1. **相互影响**：供给量和需求量都是价格 $P$ 的函数，而价格 $P$ 又由供给量和需求量共同决定。这种相互影响导致了价格 $P$ 与误差项 $\epsilon_1$ 和 $\epsilon_2$ 相关，从而引起内生性问题。
2. **误差项相关性**：由于价格 $P$ 是由供给和需求共同决定的，所以 $P$ 与 $\epsilon_1$ 和 $\epsilon_2$ 相关，导致解释变量与误差项相关，违反了经典回归模型的假设。

# 豪斯曼检验

豪斯曼检验是检验模型中是否存在内生性问题的统计方法

## **豪斯曼设定检验**：

• 以凯恩斯宏观模型为例，假设我们有如下方程：

$$C_t = \beta_0 + \beta_1 Y_{t} + \beta_2 C_{t-1} + \epsilon_t $$$$I_t = \alpha_0 + \alpha_1 Y_t + \alpha_2 Y_{t-1} + u_t $$$$Y_t = C_t + I_t$$
• 其中，$Y_t$ 是内生变量，检验 $Y_t$ 与 $\epsilon_t$ 相关。

## **豪斯曼检验的具体步骤**

1. **第一步：将 $Y_t$ 表示为模型所有前定变量的简约式**：
$$Y_t = \pi_0 + \pi_1 C_{t-1} + \pi_2 Y_{t-1} + \omega_t$$
• 由于前定变量 $C_{t-1}$ 和 $Y_{t-1}$ 与误差项 $\epsilon_t$ 不相关，因此检验 $Y_t$ 是否与 $\epsilon_t$ 相关即可转化为检验式中误差项 $\omega_t$ 是否与结构误差 $\epsilon_t$ 相关。

2. **第二步：设定辅助回归模型**：
$$\epsilon_t = \rho \omega_t + v_t$$
• 模型联立性检验转化为检验参数 $\rho$ 是否显著为0。如果 $\rho$ 为0，说明 $\omega_t$ 与 $\epsilon_t$ 不相关，反之相关。

3. **第三步：将辅助回归模型代入原方程**：
4. 
$$C_t = \beta_0 + \beta_1 Y_{t} + \beta_2 C_{t-1} + \rho \omega_t + v_t$$
• 联立性检验即是检验方程中系数 $\rho$ 是否显著异于0。

4. **具体操作**：

• 简约式误差 $\omega_t$ 通常是不可观察的，因此需要对方程进行回归，得到 $\omega_t$ 的估计值，然后再将其代入方程进行回归，并对参数 $\rho$ 进行 $t$ 检验。

# 参数识别

## 识别含义

### 解释

参数识别是指能够唯一确定模型参数的能力.简单来说，参数识别问题讨论的是在给定数据和模型结构的情况下，是否可以唯一确定模型中的所有参数。

### 举例:牛奶市场中的不可识别

在牛奶价格的供求这一部分,如果供给量和需求量都只是价格的函数.那么就只有仨方程![[Pasted image 20240617190037.png]]
此时就算去收集数据,收集到的也只是供给曲线和需求曲线焦点的数据,收集的再多也完全没法画出两条曲线的图像.  

## 引入工具变量

如果向方程中引入工具变量,


# 内生性

## 偏误和残差

**OLS估计量**

$$ \hat{\beta}_{OLS} = (X’X)^{-1} X’Y = \beta + (X’X)^{-1} X’\epsilon $$  
这个公式表示的是普通最小二乘法（OLS）的估计量。

**偏误**

$$ Bias(\hat{\beta}) = E[(X’X)^{-1} X’\epsilon] $$  
这个公式表示的是OLS估计量的偏误。

• $Bias(\hat{\beta})$：估计量的偏误。
• $E[(X’X)^{-1} X’\epsilon]$：期望值。

如果$X$是严格外生的：
$$ E[(X’X)^{-1} X’\epsilon] = 0 $$
如果$X$是弱外生的：
$$ \text{plim}_{N \to \infty} (X’X)^{-1} X’\epsilon = 0 $$
其中，$\text{plim}$表示渐进概率极限。

## **外生变量的系数估计量**

对于回归模型：
$$ y_t = \beta_0 + \beta_1 x_{1t} + \beta_2 x_{2t} + \epsilon_t $$

假设：

• $E[x_{1t}\epsilon_t] = 0$ 表示$x_1$是外生的。
• $E[x_{2t}\epsilon_t] \neq 0$ 表示$x_2$是内生的。

在这种情况下：

• $\text{plim}_{N \to \infty} \hat{\beta}_1 = \beta_1$
• $\text{plim}_{N \to \infty} \hat{\beta}_2 \neq \beta_2$

这意味着，当变量是内生时，OLS估计量将是有偏的和不一致的。

==并且内生性的传染性极强,如果X1和误差项无关.X2有偏,X1X2相关的话X1也会是有偏的==

# IV工具变量与2SLS两阶段最小二乘法

## 理解

==IV工具变量是个总的步骤,使用与当前存在内生性的变量有关但是和残差项无关的工具变量代替存在内生性的解释变量.如果工具变量和存在内生性的解释变量之间相关性好,就只用一人找一个就行(恰好识别),就用IV估计就行.如果找的多.使用了多于原来的解释变量个数的工具变量的话(过度识别),就使用两阶段最小二乘法去估计==

## **IV估计量的计算过程**

假设我们有一个简单的线性回归模型：

$$ Y = \beta_0 + \beta_1 X + \epsilon $$

其中，$X$ 是内生变量，即 $E[X’\epsilon] \neq 0$。  

### **1. 选择工具变量**

选择满足相关性和外生性条件的工具变量 $Z$，例如 $Z$ 是一个与 $X$ 相关但与 $\epsilon$ 不相关的变量。

### **2. 两阶段最小二乘法（2SLS）**

两阶段最小二乘法（2SLS）是IV估计的一种常用方法。其具体步骤如下  

**第一阶段回归**

将==内生解释变量 $X$ 用工具变量 $Z$ 进行回归==，得到内生解释变量的预测值 $\hat{X}$：
  
$$ X = \pi_0 + \pi_1 Z + v $$

估计得到 $\hat{X}$：

$$ \hat{X} = \hat{\pi}_0 + \hat{\pi}_1 Z $$

**第二阶段回归**

用第一阶段得到的预测值 $\hat{X}$ 代替原内生变量 $X$，进行第二阶段回归，得到回归系数估计值 $\hat{\beta}$：
$$ Y = \beta_0 + \beta_1 \hat{X} + \epsilon $$

### **3. IV估计量公式**

在样本矩条件下，IV估计量可以表示为：
$$ \hat{\beta}_{IV} = (Z’X)^{-1} Z’Y $$
在过度识别的情况下（即工具变量的数量大于内生变量的数量），使用两阶段最小二乘法（2SLS）进行估计：
$$ \hat{\beta}_{2SLS} = (X’Z(Z’Z)^{-1}Z’X)^{-1} X’Z(Z’Z)^{-1}Z’Y $$

==牺牲精度(方差增大)来获得更小的偏误,需要在二者做出选择.==


















