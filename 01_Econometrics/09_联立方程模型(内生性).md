
# 联立方程模型



# 内生性

**OLS估计量**

$$ \hat{\beta}_{OLS} = (X’X)^{-1} X’Y = \beta + (X’X)^{-1} X’\epsilon $$  
这个公式表示的是普通最小二乘法（OLS）的估计量。

**偏误**

$$ Bias(\hat{\beta}) = E[(X’X)^{-1} X’\epsilon] $$  
这个公式表示的是OLS估计量的偏误。

• $Bias(\hat{\beta})$：估计量的偏误。
• $E[(X’X)^{-1} X’\epsilon]$：期望值。

如果$X$是严格外生的：
$$ E[(X’X)^{-1} X’\epsilon] = 0 $$
如果$X$是弱外生的：
$$ \text{plim}_{N \to \infty} (X’X)^{-1} X’\epsilon = 0 $$
其中，$\text{plim}$表示渐进概率极限。

**外生变量的系数估计量**

对于回归模型：
$$ y_t = \beta_0 + \beta_1 x_{1t} + \beta_2 x_{2t} + \epsilon_t $$

假设：

• $E[x_{1t}\epsilon_t] = 0$ 表示$x_1$是外生的。
• $E[x_{2t}\epsilon_t] \neq 0$ 表示$x_2$是内生的。

在这种情况下：

• $\text{plim}_{N \to \infty} \hat{\beta}_1 = \beta_1$
• $\text{plim}_{N \to \infty} \hat{\beta}_2 \neq \beta_2$

这意味着，当变量是内生时，OLS估计量将是有偏的和不一致的。

==并且内生性的传染性极强,如果X1和误差项无关.X2有偏,X1X2相关的话X1也会是有偏的==

# IV工具变量与2SLS两阶段最小二乘法

==IV工具变量是个总的步骤,使用与当前存在内生性的变量有关但是和残差项无关的工具变量代替存在内生性的解释变量.如果工具变量和存在内生性的解释变量之间相关性好,就只用一人找一个就行(恰好识别),就用IV估计就行.如果找的多.使用了多于原来的解释变量个数的工具变量的话(过度识别),就使用两阶段最小二乘法去估计==

**IV估计量的计算过程**

假设我们有一个简单的线性回归模型：

$$ Y = \beta_0 + \beta_1 X + \epsilon $$

其中，$X$ 是内生变量，即 $E[X’\epsilon] \neq 0$。  

**1. 选择工具变量**

选择满足相关性和外生性条件的工具变量 $Z$，例如 $Z$ 是一个与 $X$ 相关但与 $\epsilon$ 不相关的变量。

**2. 两阶段最小二乘法（2SLS）**

两阶段最小二乘法（2SLS）是IV估计的一种常用方法。其具体步骤如下  

**第一阶段回归**

将==内生解释变量 $X$ 用工具变量 $Z$ 进行回归==，得到内生解释变量的预测值 $\hat{X}$：
  
$$ X = \pi_0 + \pi_1 Z + v $$

估计得到 $\hat{X}$：

$$ \hat{X} = \hat{\pi}_0 + \hat{\pi}_1 Z $$

**第二阶段回归**

用第一阶段得到的预测值 $\hat{X}$ 代替原内生变量 $X$，进行第二阶段回归，得到回归系数估计值 $\hat{\beta}$：
$$ Y = \beta_0 + \beta_1 \hat{X} + \epsilon $$

**3. IV估计量公式**

在样本矩条件下，IV估计量可以表示为：
$$ \hat{\beta}_{IV} = (Z’X)^{-1} Z’Y $$
在过度识别的情况下（即工具变量的数量大于内生变量的数量），使用两阶段最小二乘法（2SLS）进行估计：
$$ \hat{\beta}_{2SLS} = (X’Z(Z’Z)^{-1}Z’X)^{-1} X’Z(Z’Z)^{-1}Z’Y $$

==牺牲精度(方差增大)来获得更小的偏误,需要在二者做出选择.==
