
# 面板数据模型

## 模型内容

既有截面的数据又有时间序列内容.

$$

y_{it} = \alpha_i + \beta X_{it} + \epsilon_{it}

$$

与之前的模型不同的一点在于残差项

$$

\epsilon_{it}=\mu_i+\lambda_t+u_{it}

$$
三者分别表示总体上的残差,随时间序列的残差和随个体不同导致的残差.

## 面板数据的混合估计

面板混合OLS估计:就是直接进行OLS估计,没什么用

# 固定效用与随机效应

## **模型形式**

假设有以下面板数据模型：

$$

y_{it} = \alpha_i + \beta X_{it} +\mu_i+\lambda_t+u_{it}


$$

其中，$y_{it}$ 是第 $i$ 个个体在第 $t$ 时间的因变量，$x_{it}$ 是解释变量，$\alpha_i$ 是个体特定效应（常数，但不同个体可能不同），$\mu_i+\lambda_t+u_{it}$ 是误差项.
 
其中$u_i$被称为个体效应描述由于个体不同导致的残差值差异,$\lambda_t$被称为时间效应,描述由于时间不同导致的残差值的差异.

==下方两个效应的分析仅限静态面板数据,动态面板数据二者皆存在内生性==

## **固定效应（Fixed Effects）**

固定效应是指个体效应或时间效应与模型中的解释变量相关。

残差与模型解释变量相关会导致内生性,且同时由于不同的时间上因为个体相同而存在同样的个体效应,不同个体会因为时间相同而存在时间效应,所以同时会存在自相关问题.OLS统计量是有偏非一致的.

## 随机效应


和固定效应相反,个体效应或时间效应与模型中的解释变量不相关。

那就不存在内生性问题,但是依旧存在自相关,使OLS统计量不是最优统计量.

# 静态面板数据模型的估计

## 固定效应估计LSDV

此时由于固定效应的影响,估计量有内生性.那么使用虚拟解释变量工具变量来解决.

假设有以下面板数据模型：

$$

y_{it} = \alpha_i + \beta x_{it} + \epsilon_{it}

$$

其中：

• $y_{it}$ 是第 $i$ 个个体在第 $t$ 时间的因变量。
• $x_{it}$ 是解释变量。
• $\alpha_i$ 是个体特定效应（常数，但不同个体可能不同）。
• $\epsilon_{it}$ 是误差项。

**引入虚拟变量**

LSDV估计法通过引入虚拟变量来表示个体效应和时间效应。具体步骤如下：

**1. 引入个体虚拟变量**

对于每个个体 $i$，引入一个虚拟变量 $D_i$，当 $i = j$ 时，$D_i = 1$，否则 $D_i = 0$。

模型可以重写为：

$$

y_{it} = \alpha_0+\beta x_{it} + \sum_{i=1}^{N} \mu_i D_i + \mu_{it}

$$

  

其中，$D_i$ 是个体虚拟变量，$\mu_i$ 是个体特定效应。

**2. 消除多重共线性**

由于引入了 $N$ 个虚拟变量，会产生多重共线性问题。通常选择去掉一个虚拟变量，设定一个基准个体。例如，对于 $N$ 个个体，可以去掉$\alpha_0$。

调整后的模型为：

$$

y_{it} = \beta x_{it} + \sum_{i=1}^{N} \mu_i D_i + \mu_{it}

$$

**3. OLS估计**

如果现在剩余的残差项$\mu_{it}$是经典误差项,就可以将模型中的虚拟变量和解释变量一起进行OLS估计，得到系数估计值。

## LSDV的直观含义
  

### **模型形式**

假设我们有以下面板数据模型：

$$

y_{it} = \beta_0 + \beta_1 x_{it} + \mu_i + \lambda_t + \epsilon_{it}

$$

其中：

• $y_{it}$ 是第 $i$ 个个体在第 $t$ 时间的因变量。
• $x_{it}$ 是解释变量。
• $\mu_i$ 是个体特定效应。
• $\lambda_t$ 是时间特定效应。
• $\epsilon_{it}$ 是误差项。

实际在操作过程中我们更关心$\beta$,虚拟变量之前的数字是多少我不关心.
### LSDV估计法的步骤如下  

**1. 分别估计方程**

将因变量 $y_{it}$ 和解释变量 $x_{it}$ 分别表示为虚拟变量的线性组合和剩余项。虚拟变量表示个体效应。

$$

y_{it} = \lambda_1 D_1 + \cdots + \lambda_N D_N + \xi_{it} \tag{14.3.6}

$$

$$

x_{it} = \gamma_1 D_1 + \cdots + \gamma_N D_N + \zeta_{it} \tag{14.3.7}

$$

其中，$D_i$ 是虚拟变量，当 $i = j$ 时，$D_i = 1$，否则 $D_i = 0$；$\xi_{it}$ 和 $\zeta_{it}$ 是剩余项。

**2. 估计方程**

  对剩余项进行回归估计，得到解释变量 $x_{it}$ 的系数 $\beta_1$。

$$

\xi_{it} = \beta_1 \zeta_{it} + u_{it} \tag{14.3.8}

$$

$\xi_{it}$ 和 $\zeta_{it}$ 里是排除了虚拟解释变量影响后剩余的部分,$\beta$相关的一点没丢,直接进行OLS估计,好

### **含义**

LSDV估计法的直观含义是，将变量 $Y$ 的个体内离差对变量 $X$ 的个体内离差进行回归，并进行OLS估计。

 • **个体内离差**：表示同一个体在不同时间点上的差异。
• **OLS估计**：通过最小二乘法对回归方程进行估计，得到解释变量的系数。

通过这种方法，LSDV估计法可以消除个体效应和时间效应的影响，使得误差项与解释变量不相关，从而提高估计的准确性和可靠性。

==但是LSDV不是BLUE的估计量,所以只在不得不用的时候用,其余时候哟过FGLS==

## LSDV的R方

软件报的R方不能直接用,应该用组内R平方.就是第二种估计方法的R方,可以排除虚拟变量的影响.

### 时间效应处理方式同理

## 随机效应估计

使用GLS.因为随意两期的协方差是稳定的.就是$\mu_i$的方差.

这个GLS是FGLS即可行的GLS.

## 豪斯曼检验

如果是固定效应,那么只能用LSDV因为只有他是准的,如果存在随机效应,俩个都无偏,但是LSDV有较大的方差.

如果是固定效应,二者之间会有较大差异,因为GLS有偏LSDV无偏.
如果是随机效应,二者之间不会有显著差异

### **豪斯曼检验的基本原理**

豪斯曼检验的原理是基于以下两种假设：

1. **原假设（$H_0$）**：随机效应模型是正确的，即个体效应与解释变量无关。
2. **备选假设（$H_1$）**：固定效应模型是正确的，即个体效应与解释变量相关。

如果随机效应模型成立，固定效应模型和随机效应模型的估计结果应该没有显著差异。如果固定效应模型成立，那么两者的估计结果会有显著差异。

**检验统计量**

豪斯曼检验的统计量计算如下：

$$

H = (\hat{\beta}_{FE} - \hat{\beta}_{RE})’ \left( \text{Var}(\hat{\beta}_{FE}) - \text{Var}(\hat{\beta}_{RE}) \right)^{-1} (\hat{\beta}_{FE} - \hat{\beta}_{RE})

$$

但是这是不对的,伟大的杨继生统计量如下

$$

H = (\hat{\beta}_{FE} - \hat{\beta}_{RE})’ ( \text{Var}(\hat{\beta}_{FE-RE})) ^{-1} (\hat{\beta}_{FE} - \hat{\beta}_{RE})

$$

其中：

• $\hat{\beta}_{FE}$ 和 $\hat{\beta}_{RE}$ 分别是固定效应模型和随机效应模型的估计量。
• $\text{Var}(\hat{\beta}_{FE})$ 和 $\text{Var}(\hat{\beta}_{RE})$ 分别是对应估计量的协方差矩阵。
• $\text{Var}(\hat{\beta}_{FE-RE})$是两估计量的差值的方差协方差矩阵

检验统计量 $H$ 服从 $\chi^2$ 分布，其自由度为解释变量的个数（不包括截距项）。

### **豪斯曼检验的步骤**

1. **估计固定效应模型和随机效应模型**，得到 $\hat{\beta}_{FE}$ 和 $\hat{\beta}_{RE}$。
2. **计算协方差矩阵** $\text{Var}(\hat{\beta}_{FE})$ 和 $\text{Var}(\hat{\beta}_{RE})$。
3. **计算豪斯曼检验统计量** $H$。
4. **比较统计量** $H$ 与 $\chi^2$ 分布的临界值：
• 如果 $H$ 超过临界值，拒绝原假设，选择固定效应模型。
• 如果 $H$ 不超过临界值，接受原假设，选择随机效应模型。

P大选GLS,P小选LSDV

# 动态面板数据模型简介

## 动态面板数据的内生性问题

模型包含被解释变量的滞后项.

$$

y_{it} = \alpha + \rho y_{i,t-1} + \beta x_{it} + \epsilon_{it}

$$

其中：

 • $y_{it}$ 是第 $i$ 个个体在第 $t$ 时间的因变量。
• $y_{i,t-1}$ 是被解释变量的滞后项。
• $x_{it}$ 是解释变量。
• $\alpha$ 是截距项。
• $\rho$ 是滞后项的系数。
• $\beta$ 是解释变量的系数向量。
• $\epsilon_{it}$ 是误差项。$\epsilon_{it}= \mu_i + \lambda_t + \epsilon_{it}$

但是,在这部分的研究中只考虑 $\mu_i + \epsilon_{it}$,只要出现$\mu_i$就一定有内生性问题,但是$\lambda_t$和静态里的效果差不多,静态里该咋办这里就咋办.

### **1. GLS估计的有偏和非一致性**

**内生性问题的来源**

• **解释变量 $y_{i,t-1}$ 与误差项 $\epsilon_{it}$ 包含个体效应 $\mu_i$**：解释变量 $y_{i,t-1}$ 和误差项 $\epsilon_{it}$ 都包含个体效应 $\mu_i$，这导致它们之间存在相关性。
• **差分转换**：进行差分转换 $\Delta y_{it} = y_{i,t} - y_{i,t-1}$ 和 $\Delta \epsilon_{it} = \epsilon_{it} - \epsilon_{i,t-1}$，这些差分项中都包含共同因素 $u_{i,t-1}$，无法消除解释变量的内生性问题。

具体来说，模型进行差分后仍然会包含个体效应和滞后误差项：

$$

\Delta y_{it} = \rho \Delta y_{i,t-1} + \Delta x_{it} + \Delta \epsilon_{it}

$$

由于 $\Delta y_{i,t-1}$ 与 $\Delta \epsilon_{it}$ 之间仍然存在相关性，GLS估计的结果会有偏且不一致。

### **2. LSDV估计的有偏和非一致性**

**模型表示**

LSDV估计法通过引入虚拟变量表示个体效应，但是在动态面板数据模型中，LSDV估计同样会受到内生性问题的影响。具体模型表示为：

$$

y_{it} = \mu_1 D_1 + \cdots + \mu_N D_N + \rho y_{i,t-1} + u_{it} 

$$

其中，$D_i$ 是个体虚拟变量。

等价于模型：
$$

Y_{i,t}^* = \rho Y_{i,t-1}^* + \epsilon_{it}^* 

$$

其中，
$$

Y_{i,t}^* = Y_{i,t} - \frac{1}{T} \sum_{t=1}^{T} Y_{i,t}

$$
$$

\epsilon_{it}^* = \epsilon_{it} - \frac{1}{T} \sum_{t=1}^{T} \epsilon_{it}

$$

**内生性问题的原因**

由于 $Y_{i,t-1}$ 和 $\epsilon_{it}$ 之间存在相关性，且它们都包含误差 $\epsilon_{i,t-1}$，这导致LSDV估计也是有偏和非一致的。

## 广义矩估计方法GMM

动态面板数据模型中的广义矩估计（Generalized Method of Moments, GMM）方法是解决内生性问题的常用方法。GMM方法利用内生变量的工具变量进行估计，以获得一致的参数估计。以下是详细的介绍和步骤。

**1. 动态面板数据模型**

考虑以下动态面板数据模型：

$$

y_{it} = \alpha + \rho y_{i,t-1} + \beta x_{it} + \epsilon_{it}

$$

其中：

• $y_{it}$ 是第 $i$ 个个体在第 $t$ 时间的因变量。
• $y_{i,t-1}$ 是被解释变量的滞后项。
• $x_{it}$ 是解释变量。
• $\alpha$ 是截距项。
• $\rho$ 是滞后项的系数。
• $\beta$ 是解释变量的系数向量。
• $\epsilon_{it}$ 是误差项。

**2. 内生性问题**

滞后项 $y_{i,t-1}$ 与误差项 $\epsilon_{it}$ 相关，导致传统的估计方法（如OLS和GLS）有偏且不一致。

**3. 差分GMM方法**  

差分GMM方法通过对模型进行一阶差分消除个体效应，并使用滞后变量作为工具变量来解决内生性问题。

**模型差分**

对原模型进行一阶差分，减弱个体效应：

$$

\Delta y_{it} = \rho \Delta y_{i,t-1} + \beta \Delta x_{it} + \Delta \epsilon_{it}

$$

**工具变量选择**

使用滞后两期或更多期的变量作为工具变量，以解决内生性问题。例如，$y_{i,t-2}$ 及更早期的滞后变量可以作为工具变量。只选一个$y_{i,t-2}$是不行的,因为拟合效果差,最多可选t-2个,具体选多少个视情况而定.

**GMM估计步骤**

1. **构建矩条件**：
对于工具变量 $z_{it}$，构建矩条件 $E(z_{it} \Delta \epsilon_{it}) = 0$。
2. **求解GMM估计量**：
通过最小化矩条件的加权平方和$g(\hat{\rho})’ W g(\hat{\rho})$，求解参数估计量。

### J检验

J检验（Hansen’s J-test）是一种用于评估广义矩估计（GMM）模型有效性的统计检验。具体来说，J检验用于检验模型中使用的工具变量是否有效，以及模型是否正确指定。

**J检验的基本原理**

J检验的原假设是所有工具变量都是有效的，即工具变量与误差项不相关。如果拒绝原假设，则说明至少有一个工具变量无效，或者模型错误指定。

**统计量的构造**

J统计量的计算公式如下：

$$

J = NTg(\hat{\rho})’ W g(\hat{\rho}) \sim \chi^2(m - k)

$$

其中：

• $N$ 是样本量。
• $T$ 是时间维度的长度。
• $\hat{\rho}$ 是通过GMM估计得到的参数向量。
• $g(\hat{\rho})$ 是根据参数向量 $\hat{\beta}$ 计算得到的样本矩。
• $W$ 是 $m \times m$ 的加权矩阵。
• $m$ 是矩条件的个数。
• $k$ 是待估计参数的个数。
• $\chi^2(m - k)$ 是自由度为 $(m - k)$ 的卡方分布。

**J检验的步骤**  

1. **估计参数**：使用GMM方法估计模型参数 $\hat{\beta}$。
2. **计算残差**：根据估计的参数计算残差 $\hat{\epsilon}$。
3. **构建矩条件**：计算工具变量与残差的样本均值 $g(\hat{\beta})$。
4. **计算J统计量**：根据上述公式计算J统计量。
5. **进行检验**：将J统计量与自由度为 $(m - k)$ 的 $\chi^2$ 临界值进行比较。

• 如果J统计量大于临界值，拒绝原假设，说明工具变量无效或模型错误指定。
• 如果J统计量小于或等于临界值，接受原假设，说明工具变量有效，模型正确指定。
