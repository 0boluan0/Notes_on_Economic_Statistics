 
# 多元线性回归的两个例子

## CD生产函数

即柯布道格拉斯生产函数
![[Pasted image 20240316170040.png]]
虽然在这种情况下不是线性的，但是可以对两边取对数来得到线性的式子。
![[Pasted image 20240316170125.png]]

## 新凯恩斯混合菲利普斯曲线

![[Pasted image 20240325145241.png]]

## 多元线性回归的一般形式

![[Pasted image 20240325201030.png]]
## 偏效应

在数学上相当于偏导，具有很好的经济学意义，反应一个解释变量改变且其他的解释变量不变时Y所受的影响。但是事实上是不存在的，

# 多元线性回归模型的OLS估计

## 回归系数的估计

求离差平方和最小，得OLS估计量。
即求偏导得0
![[Pasted image 20240329171645.png]]
得正规方程组
![[Pasted image 20240329171704.png]]
也就是![[Pasted image 20240606122324.png]]

正规方程组很难算,将其变换为行列式的形式.
![[Pasted image 20240606122411.png]]
得到![[Pasted image 20240606123443.png]]

### 多重共线性

回归模型的解释变量之间不能存在完全的多重共线性。多重共线性是指在多元线性回归模型中，自变量之间存在高度相关性的情况。这种情况会导致回归系数的估计不准确，使得模型的结果难以解释和预测。简单来说，就是自变量之间有很强的相关性，导致模型难以准确地估计出每个自变量对因变量的影响。

完全的多重共线性：是指一个解释变量是、其他解释变量的线性组合 。 说明该解释变量所提供的信息与其他解释变量是完全重复的。

### 多元线性回归的高斯马尔可夫定律

仅在一元线性回归的基础上增加了一条。即不能存在完全的多重共线性。

### 系数计算：以二元回归模型为例

![[Pasted image 20240331150552.png]]
![[Pasted image 20240331150638.png]]
![[Pasted image 20240331150722.png]]

## 随机误差项方差的估计

![[Pasted image 20240331160623.png]]

自由度是N-K-1，因为总共有N个不等式，收到了K+1的约束（正规方程组）

![[Pasted image 20240606151938.png]]

## 判定系数的调整

原先的TSS，RSS，ESS反应拟合程度，但是没有考虑参数的个数。只要我无限增加解释变量就能让R方无限逼近于1。这显然是与这个解释变量设立的目的相违背的。所以应该对其进行调整。
![[Pasted image 20240331161930.png]]

调整后如果想要增加新的解释变量的话就要考虑自由度和解释能力的权衡了。

# 多元线性回归模型的假设检验

## 单参数检验:T检验

使用t检验
只能检验单个参数，而且分别检验不同的参数是无意义的。
和一元线性回归模型只有自由度的区别，别的是一样的。

此时![[Pasted image 20240610154140.png]]

其中(1/1-R1方)是方差膨胀因子,是这个解释变量对别的解释变量求回归的方程的R方.R方越大说明独有信息越小,此时方差越大

![[Pasted image 20240331200913.png]]

## 多参数检验:F检验

验证多个参数是否同时成立。
![[Pasted image 20240331201000.png]]
![[Pasted image 20240331201029.png]]
![[Pasted image 20240331205225.png]]


### F检验的基本原理

F检验通过比较模型的方差来判断模型是否显著。具体来说，它比较的是在加入解释变量前后的模型残差平方和的差异。

### F检验统计量

F检验统计量的计算公式如下：

$$
F = \frac{(RSS_{R} - RSS_{UR}) / (df_{R} - df_{UR})}{RSS_{UR} / df_{UR}}
$$

其中：

•	 $RSS_{R}$  是受限模型的残差平方和。
•	 $RSS_{UR}$  是非受限模型的残差平方和。
•	 $df_{R}$  是受限模型的自由度。
•	 $df_{UR}$  是非受限模型的自由度。

F统计量服从  F  分布，其自由度为 $(df_{R} - df_{UR}, df_{UR})$。

### F检验的步骤

1.	构建模型：
	•	受限模型：不包含某些解释变量的模型。
	•	非受限模型：包含所有解释变量的模型。
2.	计算残差平方和（RSS）：
	•	计算受限模型和非受限模型的残差平方和。
3.	计算F统计量：
	•	根据上述公式计算F统计量。
4.	比较临界值：
	•	将计算的F统计量与F分布的临界值进行比较，判断是否拒绝原假设。

### 具体步骤示例

假设我们有以下回归模型：

受限模型（不包含某些解释变量）：
$$
y_i = \beta_0 + \beta_1 x_{1i} + \epsilon_i
$$

非受限模型（包含所有解释变量）：
$$
y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} + \epsilon_i
$$

数学过程

1.	构建受限模型和非受限模型：

受限模型：
$$
y_i = \beta_0 + \beta_1 x_{1i} + \epsilon_i
$$

非受限模型：
$$
y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} + \epsilon_i
$$

2.	计算残差平方和（RSS）：

受限模型的残差平方和：
$$
RSS_{R} = \sum_{i=1}^{n} (y_i - \hat{y}_{R,i})^2
$$

非受限模型的残差平方和：
$$
RSS_{UR} = \sum_{i=1}^{n} (y_i - \hat{y}_{UR,i})^2
$$

3.	计算自由度（df）：

受限模型的自由度：
$$
df_{R} = n - k_R
$$
其中，$k_R$ 是受限模型中的参数个数。

非受限模型的自由度：
$$
df_{UR} = n - k_{UR}
$$
其中，$k_{UR}$ 是非受限模型中的参数个数。

4.	计算F统计量：

$$
F = \frac{(RSS_{R} - RSS_{UR}) / (df_{R} - df_{UR})}{RSS_{UR} / df_{UR}}
$$

f检验只有一个拒绝域,不能做双侧检验,因为不论什么原因,都会落到上维度去,看不来是小了还是大了,但是可以检验多个约束. 

### F检验的一个例子:邹检验

检验92年前后中国宏观生产函数是否改变写俩方程,无约束的认为俩方程是分开的,,有约束的认为俩方程参数相等.无约束的RSS就是俩方程的简单加和,有约束的就是那个方程的rss.

![[Pasted image 20240609211513.png]]

邹检验不好,因为样本容量不同.方差不一样,样本容量大了方差小.而且做邹检验要做三个回归.  

且不可识别差异的来源.

# 极大似然估计与似然比检验

## 极大似然估计

认为观测到的因变量的值是在给定自变量的值的情况下最大可能的取值,当样本足够的大,就会收敛到真值.
所以吧所有的出现的x对应的y的概率乘起来取对数求偏导令导得零就能得到估计值.

## 似然比检验

无约束的对数似然函数值-受约束的对数似然函数值服从卡方(q)的分布,用这个检验
![[Pasted image 20240609231618.png]]
![[Pasted image 20240608154123.png]]
这是一个大样本检验,因为这里应该使用西格玛而非西格玛hat,这里只能用西格玛hat,在大样本条件下西格玛hat渐进等于西格玛.

# 线性回归模型的扩展

## 含有对数变化的模型

![[Pasted image 20240608163139.png]]

## 环境库涅滋曲线

==这是一个线性的方程,但是对GDP求导不能反映偏效应==
![[Pasted image 20240608164501.png]]

# 多元回归分析实例:货币需求分析

## JB正态性检验

检验统计量的分布和正态分布的远近
![[Pasted image 20240608190012.png]]
JB统计量服从卡方(2)分布

# 分布滞后模型与解释变量的选择

## 分布滞后模型

模型包含解释变量的滞后项
![[Pasted image 20240608193612.png]]

## 滞后项阶数的选择

从最大的依次往下减.使用信息准则判断减的对不对

### 赤池信息准则AIC

![[Pasted image 20240608195613.png]]
其中T是总的观测项的个数,m是滞后项的阶数.

### 施瓦茨准则SC

![[Pasted image 20240608200200.png]]

调整m使得AIC或SC最小