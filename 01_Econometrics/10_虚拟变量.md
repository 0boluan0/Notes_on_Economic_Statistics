
虚拟变量做解释变量,虚拟变量做被解释变量的时候叫离散选择模型.

# 虚拟解释变量

## 什么是虚拟变量

就是独热编码.01意思是是和否,判别该变量是否处于某状态.

## 处理

引入虚拟变量,相当于吧样本分成了两个子样本,后面该干什么干什么.使用t或F检验看是否为0就行.

方程里只能引入类型-1的虚拟变量,以防止完全的多重共线性.非要搞就吧B0删掉.、

# 虚拟被解释变量

## 描述

被解释变量是虚拟变量,意味着当解释变量拟合出的潜在效用函数超过某一阈值时,被解释变量的状态改变.但是这也有问题.拟合出来的值只有序列意义而没有绝对值意义.所以阈值取几都行,因为数字本身无意义.
  

### 1. **潜在效用函数**：
$$ y^* = x’\beta + \epsilon $$
• $y^*$ 是一个连续的、不可观察的效用或意愿，表示一个人对某个选项的偏好程度。
• $x$ 是解释变量的向量，比如影响选择的因素（年龄、收入、教育水平等）。
• $\beta$ 是待估计的参数向量，反映了每个解释变量对效用的影响。
• $\epsilon$ 是误差项，表示随机的影响因素。

### 2. **实际选择结果**：
• 当潜在效用 $y^*$ 超过某个临界值（这里为0），选择结果 $y$ 取值为1（表示选择了某个选项）。

• 当潜在效用 $y^*$ 不超过临界值（0），选择结果 $y$ 取值为0（表示未选择某个选项）。

## LPM估计参数$\beta$

### LPM过程

$y^*$不能直接观测,且y的值不能进行回归,1和0表现的是状态,而非数值.最后拟合的是选1的概率.但是因为是线性,所以会有大于1和小于0的概率.

选取一个阈值,大于该阈值的我们预测其取1,小于该阈值的认为取0.

### 问题

残差只取两个值,存在异方差,所以不能用,不满足正态性假定,不能进行假设检验.不用.这种回归在计量里面不会做的.

直接进行OLS,有很好的经济解释能力,企业常用.虽然不是最优但是凑活能使.

### 改进的检验能力衡量统计量$R_p^2$

预测1对的比例和预测对0的比例取平均得到$R_p^2$

## 非线性拟合

### 函数的选择

取值在01之间,并且单调递增,两边平缓,中间陡峭.因为真实的经济关系是阶梯,最陡.  

根据目标,选择累计分布函数.

现在计算Y取1的概率,而非临界值,概率在中间突变,所以拟合的形式是中间突变的函数
![[Pasted image 20240618203604.png]]
红线是蓝线的一阶导.需要在0点尽可能的大.有很多的选择,但是别的中间不够大,突变的不够快.


### logit模型

#### 内容描述

使用逻辑分布函数模型描述选1的概率

$$ P(Y=1|X) = \frac{1}{1 + e^{-(\beta_0 + \beta_1X_1 + \beta_2X_2 + … + \beta_kX_k)}} $$

$beta$等会用极大似然估计来求解.

logit模型进行线性化后得到的形式是解释变量的线性组合.此时的模型写作:
.$$
 L_i = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + … + \beta_k X_k $$
此时的随机误差服从均值为0,方差为$$\frac{1}{n_i p_i (1 - p_i)}$$的正态分布.

#### 机会比率

机会比率表示自变量增加一个单位时，事件发生的几率相对于不发生的几率的变化。具体来说，机会比率是逻辑回归模型中每个回归系数的指数值。

如果逻辑回归模型的形式为：

这一步叫做logit模型的线性化.
$$
 \ln\left( \frac{P(Y=1|X)}{1 - P(Y=1|X)} \right) = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + … + \beta_k X_k $$
 
事实上P(Y=1|X)是不知道的,所以经济研究中不用这个方程.


那么，机会比率 (OR_i) 为：
 $$OR_i = e^{\beta_i} $$


*	(OR > 1)：表示自变量的增加会增加事件发生的几率。
*    (OR = 1)：表示自变量的增加不会改变事件发生的几率。
*	OR < 1：表示自变量的增加会减少事件发生的几率。

#### logit模型的估计(生物医学方法)

如果能算出pi,那就是能估计的.logit模型的误差项和pi有关,所以有异方差,那么就用加权最小二乘法WLS,加权后得到同方差的估计量.而后可以进行假设检验.

#### logit模型估计(经济学方法)

1. **假设**：
• $Y_i$ 表示第 $i$ 个观测值的二元因变量，$Y_i \in {0, 1}$。
• $X_i$ 表示第 $i$ 个观测值的解释变量向量。
• $\beta$ 是待估计的参数向量。

2. **Logit模型的概率形式**：

$$ P(Y_i = 1 | X_i) = \frac{1}{1 + e^{-X_i’\beta}} $$
$$ P(Y_i = 0 | X_i) = 1 - P(Y_i = 1 | X_i) = \frac{e^{-X_i’\beta}}{1 + e^{-X_i’\beta}} $$

3. **似然函数**：

给定 $n$ 个观测值，Logit模型的似然函数 $L(\beta)$ 为：
$$ L(\beta) = \prod_{i=1}^{n} P(Y_i | X_i, \beta) $$
由于 $Y_i$ 是二元变量，似然函数可以表示为：
$$ L(\beta) = \prod_{i=1}^{n} \left(\frac{1}{1 + e^{-X_i’\beta}}\right)^{Y_i} \left(\frac{e^{-X_i’\beta}}{1 + e^{-X_i’\beta}}\right)^{1 - Y_i} $$

4. **对数似然函数**：

为了简化计算，通常对似然函数取对数，得到对数似然函数 $\ell(\beta)$：
$$ \ell(\beta) = \sum_{i=1}^{n} \left[ Y_i \ln\left(\frac{1}{1 + e^{-X_i’\beta}}\right) + (1 - Y_i) \ln\left(\frac{e^{-X_i’\beta}}{1 + e^{-X_i’\beta}}\right) \right] $$
简化后为：
$$ \ell(\beta) = \sum_{i=1}^{n} \left[ Y_i X_i’\beta - \ln(1 + e^{X_i’\beta}) \right] $$

5. **极大化对数似然函数**：

为了找到最优的 $\beta$，需要极大化对数似然函数 $\ell(\beta)$。求导然后令导得0️零.
