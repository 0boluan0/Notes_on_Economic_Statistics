==主要讲低阶差分方程,考试最多考到二阶==

# 1.介绍

## 1.1 术语:算子operator

从一个拓扑空间到另一个拓扑空间的映射.

## 1.2术语:差分算子Difference operator

设 $f(x)$ 是一个离散函数（即 $f(x)$ 只在某些离散点 $x$ 取值），我们定义**前向差分算子（Forward Difference Operator）** $\Delta$ 为：
$$\Delta f(x) = f(x+ h) - f(x)$$
其中 $h$ 是步长（通常取 $h=1$）。

**直观理解**：$\Delta f(x)$ 计算的是 $f(x)$ 在 $x$ 处的增量，相当于离散版本的**一阶导数**。

## 1.3术语:滞后算子Lag operator

对于一个时间序列 ${y_t}$，滞后算子 $L$ 作用在 $y_t$ 上的定义是：
$$ y_t = y_{t-1}$$
即 $L$ 让时间序列的值向后移动一个时间单位。

更一般地，$L^k$ 表示向后滞后 $k$ 期：
$$L^k y_t = y_{t-k}$$

## 1.4 为什么要进行差分方程

考虑经典的分解方法：
$$y_t = T_t + S_t + I_t$$
并设：
$$T_t = 1 + 0.1 t, \quad S_t = 1.6 \sin\left(\frac{t\pi}{6}\right), \quad I_t = 0.7 I_{t-1} + \varepsilon_t$$

1. **趋势成分（Trend Component）$T_t$**  
   这里的趋势项 $T_t = 1 + 0.1 t$ 表示 $y_t$ 随着时间 $t$ 线性增长，每个时间点 $t$ 增加 $0.1$。
2. **季节成分（Seasonal Component）$S_t$**  
   季节项 $S_t = 1.6 \sin(t\pi/6)$ 采用正弦函数，表示 $y_t$ 随着时间 $t$ 具有周期性变化。周期为 $12$（因为 $\sin$ 函数的周期是 $2\pi$，即 $t\pi/6 = 2\pi$ 对应 $t=12$），说明该数据可能有**年度季节性**（比如按月变化的经济指标）。
3. **不规则成分（Irregular Component）$I_t$**  
   不规则项 $I_t$ 由一阶自回归模型（AR(1) 过程）给出：
   $$I_t = 0.7 I_{t-1} + \varepsilon_t$$
   其中 $\varepsilon_t$ 是随机扰动，表示无法预测的随机变化。这个方程表示 $I_t$ 依赖于其前一期值 $I_{t-1}$，并受到随机冲击的影响。这是一种**平稳时间序列模型**，如果 $|\phi| < 1$（这里 $\phi = 0.7$），则该过程是均值回归的，不会发散。
4. **差分方程（Difference Equation）**  
   差分方程本质上是描述变量如何通过**过去的滞后值**和**当前时间点的信息**来决定当前值的方程。在这里：
   - **$T_t$ 作为趋势项是一个** **线性方程**，它随时间变化但不依赖于滞后值。
   - **$S_t$ 作为季节项是一个** **周期性方程**，它依赖于时间 $t$，但没有滞后依赖。
   - **$I_t$ 是一个一阶差分方程（AR(1) 模型）**，表示它的当前值由上一期的值和一个随机误差项决定。

# 2.线性差分方程和其解Linear Difference Equation and Its Solution

## 2.1线性差分方程

<span style="color: yellow;">线性差分方程的“线性”指的是在方程中，变量及其滞后项只以一次幂出现，并且不会相互乘积或出现在非线性函数中。</span>

具有常系数的$n$ 阶线性差分方程的一般形式如下所示：
$$y_t = a_0 + \sum_{i=1}^n a_i \, y_{t-i} + x_t$$

1. **$n$ 阶线性差分方程**  
   这里的方程：
   $$y_t = a_0 + \sum_{i=1}^n a_i \, y_{t-i} + x_t$$
   表示当前时刻 $t$ 的变量 $y_t$ 可以由其过去 $n$ 期的值 $y_{t-1}, y_{t-2}, \dots, y_{t-n}$ 以及一个额外的外生项 $x_t$ 决定。系数 $a_0, a_1, \dots, a_n$ 都是常数。
2. **外生过程（Forcing Process）$x_t$**  
   - $x_t$ 可以是时间 $t$ 的确定性函数，比如趋势或季节性项。
   - 也可以是其他经济变量（或随机过程）的滞后值或当前值。
   - 或者是随机扰动，如白噪声的加权和，$x_t = \sum_{i=0}^\infty \beta_i \, \varepsilon_{t-i}$，这在时间序列和信号处理中都很常见。
3. **差分算子表示**  
   差分算子 $\Delta$ 定义为 $\Delta y_t = y_t - y_{t-1}$。  
   将方程用 $\Delta y_t$ 表示时：
   $$
   \Delta y_t = a_0 + \gamma \, y_{t-1} + \sum_{i=2}^n a_i \, y_{t-i} + x_t
   $$
   其中 $\gamma = a_1 - 1$。这是把一阶差分后的 $y_t$ 与其滞后值联系起来的一种写法，有时在研究单位根、平稳性等问题时更方便。

## 2.2 差分方程的解

一个差分方程的解，给出了 $y_t$ 如何作为 $\{x_t\}$ 的元素与时间 $t$（以及可能给定的 $y_t$ 序列初始条件）来确定其数值的函数形式。这可以类比微积分中的解微分方程。

- 在微分方程中，我们通常说“解”是一个函数，它告诉我们如何根据自变量（如时间 $t$）以及必要的初始条件来确定未知函数的值。  
- 对差分方程而言，情况类似：一个差分方程的解就是告诉我们 **$y_t$** 如何由过去或当前的外生序列 **$\{x_t\}$**、时间 **$t$** 以及可能给定的初始条件（如 **$y_0, y_1, \dots$**）来确定。  
  - **微分方程**：需要初始值（或边界值）才能唯一确定解；  
  - **差分方程**：也需要初始条件（如早期的几个 $y_t$ 的值），然后才能向前（或向后）迭代出整个序列的解。  

因此，这句话的意思是：**差分方程的解，就像微分方程的解一样，能明确表示“在给定初始条件和外生变量的情况下，$y_t$ 的具体取值是怎样随时间演化的”。**  

>[!example] **示例 1**：
>  $$\Delta y_t = 2$$  
>  其解为  
>  $$y_t = 2t + c$$  
>  其中 $c$ 是任意常数。我们可以通过代入来验证。

>[!example] **示例 2**：  
>  $$I_t = 0.7 I_{t-1} + \varepsilon_t$$  （这是不规则成分 $I_t$ 的模型），其解为  
>  $$I_t = \sum_{i=0}^\infty 0.7^i \,\varepsilon_{t-i}$$  
>  同样可以通过代入来验证。

上面这些解只是直接“假设”出来的吗？有没有什么方法可以系统地求解这些差分方程呢？

1. **迭代展开（Forward Iteration）**  
   - 对于形如  
     $$I_t = 0.7 I_{t-1} + \varepsilon_t,$$  
     可以反复向前展开：  
     $$
     I_t 
     = 0.7 I_{t-1} + \varepsilon_t 
     = 0.7 \bigl(0.7 I_{t-2} + \varepsilon_{t-1}\bigr) + \varepsilon_t 
     = 0.7^2 I_{t-2} + 0.7 \varepsilon_{t-1} + \varepsilon_t
     $$
     继续迭代，就能得到  
     $$
     I_t = 0.7^k I_{t-k} + \sum_{i=0}^{k-1} 0.7^i \,\varepsilon_{t-i}.
     $$
     当 $|0.7|<1$ 且 $k \to \infty$，$0.7^k I_{t-k}$ 收敛为 0，最终得到  
     $$
     I_t = \sum_{i=0}^{\infty} 0.7^i \,\varepsilon_{t-i},
     $$
     这与示例中的解相符。

2. **特征方程法（Characteristic Equation）**  
   - 对于线性齐次差分方程，如  
     $$\Delta y_t = 2 \quad \Longleftrightarrow \quad y_t - y_{t-1} = 2,$$  
     可以先求其齐次解和 particular 解。  
     - 齐次方程：  
       $$y_t - y_{t-1} = 0,$$  
       其解为常数或等比数列。  
     - 特殊解（particular solution）：  
       由于右边是常数 2，假设 $y_t = A t + B$ 形式，代入方程解出 $A=2$，$B$ 可并入常数项。  
     - 因此总解为  
       $$y_t = 2t + c,$$  
       其中 $c$ 是由初始条件决定的常数。

# 3.蛛网模型 Cobweb Model

# 4. 解齐次微分方程Solving Homogeneous Difference Equations

# 5. 找特解Finding Particular Solution

# 6.作业

