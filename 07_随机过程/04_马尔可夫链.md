
# 考试内容

- 定义  
- 一步转移概率、$N$步转移概率、$C_k$ 方程  
- 状态分类（周期、非周期）、首中概率定义  
- 正常返、零常返、非常返定义  
- 遍历定义  
- 连通性、状态互通的定义和性质  
- 状态空间的分解、闭集、闭集分布不可约  

**两个分解**：  
1. 周期的马氏链的分解  
2. $n$步转移概率  

平稳分布：  
- 存在性条件：在有限状态时，规定 $m$步转移概率矩阵里面没有 $0$ 元素  
- 求法：$π$ 是一个横向量  

吸收马氏链：表示方式和基本性质  

----

# 1.定义与相关概念

## 1.1定义

- **定义**：马尔可夫链是一个随机过程 {Xn, n∈T}，其中T是离散的时间集合，且满足马尔可夫性。
    - **马尔可夫性**：在已知当前状态的条件下，未来的状态与过去的状态无关，即**无后效性**。
        - 数学表达：对于任意整数n∈T和任意状态i0, i1, …, in+1∈I，条件概率满足 P(Xn+1 = in+1 | X0 = i0, X1 = i1, ..., Xn = in) = P(Xn+1 = in+1 | Xn = in)
    - 时间和状态都是离散的马尔可夫过程被称为马尔可夫链.

- **初始分布与绝对概率**：
    - 初始分布：马尔可夫链在初始时刻的概率分布，用初始概率向量$P^T(0)$表示 .
    - 绝对概率：马尔可夫链在时刻n处于状态j的概率，记为$p_j(n).$
    - $p_j(n) = \sum\limits_{i∈I} p_i(0)p_{ij}(n).$

## **1.2 一步转移概率**：

- 定义：在时刻n，系统从状态i转移到状态j的条件概率，记为$p_{ij}(n) = P(X_n+1 = j | X_n = i)$ .
    - **齐次马尔可夫链**：如果转移概率与时间n无关，即$p_ij(n) = p_ij$，则称该马尔可夫链是齐次的，通常只讨论齐次马尔可夫链.
- **一步转移概率矩阵**：由一步转移概率组成的矩阵，记为P.
    - 性质：矩阵中的元素非负，且每行元素之和为1，即为一个随机矩阵.

## **1.3 n步转移概率**：
   
	
- 定义：在给定时刻m状态为i的条件下，经过n步后到达状态j的概率，记为$p_{ij}(n) = P(X_{m+n} = j | X_m = i)$.
- **n步转移矩阵**：由n步转移概率组成的矩阵，记为P(n).
     - P(n) = Pn

## 1.4 C-k方程

- **Chapman-Kolmogorov方程**：描述多步转移概率的性质，对于任意整数 n ≥ 0, 0 ≤ l < n 和 i, j ∈ I, 有 :
    - $$p_{ij}(n) = \sum_{k∈I} p_{ik}(l) p_{kj}(n-l)$$
    - $P(n) = P(l)P(n-l)$

---



# **2.马尔可夫链的状态分类**：

## **2.1 周期性**

• 对于一个状态$i$，定义其**周期** (period) 为

$$
d(i) = \gcd\{n : P{X_n = i \mid X_0 = i} > 0\}.
$$

这里 \gcd 表示最大公因数，集合中包含了从$i$回到$i$的所有可能步数。

• 若 $d(i) > 1$，则称状态$i$具有**周期性**；若 $d(i) = 1$，则称状态$i$是**非周期性 (aperiodic)** 的。
• 若马尔可夫链中所有状态都非周期性，则称整条链是**非周期性的**。

## **2.2常返性**

### 2.2.1 **首中概率**: 

$f_{ij}(n)$ 表示从状态 _i_ 出发，经过 _n_ 步首次到达状态 _j_ 的概率；$f_{ij}$ 表示从状态 _i_ 出发，经过有限步最终首次到达状态 _j_ 的概率。
    
### 2.2.2**常反性定义**：

• 对于一个马尔可夫链 (离散时齐)，若状态$i$满足：

1. 以概率 1 能够从$i$重新回到$i$（称“必返”或“可返”）；
2. 从$i$到$i$的平均返回时间有限，

则称该状态$i$为**常返状态** (positively recurrent)。若所有状态均为常返，则称该马尔可夫链为**常返链**。

==对于非常反过程有:$$\sum_{n=0}^{\infty}  P_{ii}^{(n)}=\frac{1}{1-f_{ii}}$$==
==对于常反过程,周期为d==
$$\lim_{n \to \infty}p_{ii}^{(nd)}=\frac{d}{\mu_i} $$

####  **正常返和零常返**：

在确定了一个状态是常反态后,可以使用$\mu$来进一步将常反态划分为正常反和零常反

• 设 $T_i$ 表示从状态$i$第一次回到$i$所需的步数（称为第一次回归时间），若
$$
P\{T_i < \infty \mid X_0 = i\} = 1
$$
且
$$
E[T_i \mid X_0 = i] < \infty,
$$
则状态$i$是**常返**的。
• 若上述期望返回时间是无限，则称状态$i$为**零常返 (null recurrent)**。
 **定义**：如果 _μ**i**_ < ∞，则称常返状态 _i_ 为**正常返的**；如果 _μ**i**_= ∞，则称常返状态 _i_ 为**零常返的**。

### 2.2.3- **遍历状态**：

**非周期**的**正常返**状态称为**遍历状态**。

### 2.2.4 **状态的互通**：

不管概率多大,只要 i 到 j 的概率不为0就叫 i 可达 j 
如果状态 _i_ 可以到达状态 _j_，且状态 _j_ 可以到达状态 _i_，则称状态 _i_ 和 _j_ 是**互通的**。

可达和互通关系都有传递性

==两状态互通则周期相同性质,状态分类相同==

# **3.状态空间的分解**

## 3.1状态空间分解后

- **闭集**：状态空间 _I_ 的子集 _C_，如果从 _C_ 中的状态出发，永远不能到达 _C_ 以外的状态。里面的出不去
- **不可约闭集**：如果闭集 _C_ 中的任意两个状态互通，则称闭集 _C_ 是**不可约的**。就是不能再往下分了.
- 状态空间 _I_ 可以被唯一分解为若干个互不相交的子集，包括若干个**常返态**组成的**不可约闭集**和由全体**非常返状态**组成的集合.
- 总体如果是不可约闭集则整个过程为不可约链

## 3.2周期同余分解

**周期同余分解**（Cyclic Congruence Decomposition）是一种数学方法，主要用于将整数集或整数序列按照给定的模数  m  分解成若干个 **同余类**（Cyclic Classes）。每个同余类包含所有满足同余关系的整数。

在马尔可夫链中，状态  i  的周期定义为：$d(i) = \gcd\{n \geq 1 \mid P^n(i, i) > 0\},$即从状态  i  返回到自身所需的时间步长的最大公约数。如果所有状态的周期  d(i) > 1 ，则链是**周期性的**；如果  d(i) = 1 ，则链是**非周期性的**。对于不可约马尔可夫链，所有状态共享相同的周期  d 。

对于同一不可约链的状态,周期相同,那就根据$f_{ii}$首次不等于0的n,对其取d的模.将所有的状态划分为d类

这样的好处是可以将周期作为新的马尔可夫链的步长,可以吧原来很多个状态划分为至多n个状态

# **平稳分布**

- **定义**：如果一个概率分布 {_π**j**_, _j_∈_I_} 满足 **π**j = ∑_i_∈_I_**π**i*** _p**ij**_，则称其为马尔可夫链的**平稳分布**。
- **平稳分布的存在性条件**：在有限状态时，如果 _m_ 步转移概率矩阵里面没有 0 元素，则存在平稳分布。
- **不可约非周期马尔可夫链是正常返的充要条件是存在平稳分布**。
- **平稳分布的求解**：通过求解 **π** = **π**P，且 ∑_j_∈_I_**π**j*** = 1。

### **吸收马尔可夫链**

- **定义**：至少包含一个**吸收态**（一旦进入就无法离开的状态）的马尔可夫链。
- **性质**：
    - **Q 矩阵**（非吸收态之间的转移矩阵）至少有一行的和不为 1，且 Qn 收敛到 0 矩阵。
    - **基本矩阵** _W_ = _I_ + _Q_ + _Q_2 + ...，表示从**非常返态** _i_ 到**非常返态** _j_ 在被吸收之前的平均到达次数。
    - _F_ = _WR_，其中 _R_ 是从**非吸收态**到**吸收态**的转移矩阵，_F_ 表示从**非吸收态**到**吸收态**的最终概率。

请注意，以上总结主要基于您提供的文档。其中, 来自 “00_随机考点.md”； 来自 “04_马尔可夫链.pdf”，来自 “随机过程第5版 刘次华 Z-Library.pdf”。