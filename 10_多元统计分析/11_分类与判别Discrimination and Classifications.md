
# 1. 引言

判别和分类是多变量技术，用于区分不同对象集（或观测）并将新对象分配到先前定义的组。其目标包括：
1. 通过图形或代数方法描述不同集合中对象的差异特征。
2. 将对象（观测）分为两个或多个标记类别。

约定术语：
- **判别**：描述差异特征。
- **分类**：将对象分配到类别中。

---

# 2. 两个总体的区分与分类

## 目标
- 区分两类对象或将新对象分配到两类之一。

## 术语
- 两个总体：$\pi_1$ 和 $\pi_2$。
- 测量变量：$X$。

## 示例
| 人群 $\pi_1$ 和 $\pi_2$ | 测量变量 $X$               |
| -------------------- | ---------------------- |
| 偿付能力保险公司与财务困境保险公司    | 总资产、股票和债券成本、市场价值、保费支出等 |
| 新产品购买者与滞后者（购买速度慢）    | 教育水平、收入、家庭规模、品牌切换次数等   |
| 成功与失败（未毕业）大学生        | 入学考试成绩、高中平均分、高中活动数量等   |
| 良好与较差的信用风险           | 收入、年龄、信用卡数量、家庭规模等      |

---

# 3. Discrimination函数的设定

## 假设
1. **先验概率**：两总体的相对规模已知。较大总体倾向于被分配更多个体，除非有强烈证据支持较小总体。
2. **误分类成本**：不同总体的误分类成本可能不同。
3. **概率密度函数**：两总体中数值变量的分布。

## 判别规则
- 定义分类区域：
  - $R_1$: 分配到 $\pi_1$ 的区域。
  - $R_2$: 分配到 $\pi_2$ 的区域，满足 $R_2 = \Omega - R_1$。
  
## 含义
$$
P(1|1) = P(X \in R_1 | \pi_1) = \int_{R_1} f_1(x) dx
$$
**解释**:
• $P(1|1)$ 表示对象属于总体 $\pi_1$ 且被正确分类到区域 $R_1$ 的条件概率。
• 计算方法是将总体 $\pi_1$ 中对象的概率密度函数 $f_1(x)$ 在区域 $R_1$ 上积分，得到正确分类到 $\pi_1$ 的总概率。
$$
P(2|1) = P(X \in R_2 | \pi_1) = \int_{R_2=\Omega - R_1} f_1(x) dx = 1 - P(1|1)
$$
**解释**:
• $P(2|1)$ 表示对象属于总体 $\pi_1$ 却被错误分类到区域 $R_2$ 的条件概率。
• $R_2$ 是区域 $R_1$ 的补集，表示与 $\pi_1$ 分类相反的区域。
• 由于 $\pi_1$ 的总概率为 1，因此误分类到 $R_2$ 的概率可以用 $1 - P(1|1)$ 表示。
$$
P(2|2) = P(X \in R_2 | \pi_2) = \int_{R_2} f_2(x) dx
$$
**解释**:
• $P(2|2)$ 表示对象属于总体 $\pi_2$ 且被正确分类到区域 $R_2$ 的条件概率。
• 计算方法是将总体 $\pi_2$ 的概率密度函数 $f_2(x)$ 在区域 $R_2$ 上积分。
$$
P(1|2) = P(X \in R_1 | \pi_2) = \int_{R_1} f_2(x) dx = 1 - P(2|2)
$$
**解释**:
• $P(1|2)$ 表示对象属于总体 $\pi_2$ 却被错误分类到区域 $R_1$ 的条件概率。
• 类似于公式 2，由于 $\pi_2$ 的总概率为 1，误分类到 $R_1$ 的概率为 $1 - P(2|2)$。

---

# 4. Fisher 判别方法

## 核心思想
通过线性变换，将多变量 $X$ 转化为单变量 $Y$，以便两类总体（$\pi_1$, $\pi_2$）差异最大化。

## 公式
- 判别向量 $\hat{a} = S_{\text{pooled}}^{-1}(x_1 - x_2)$。
- 判别规则：分配 $x_0$ 到 $\pi_1$，如果：
  $$ \hat{a}'x_0 \geq \frac{1}{2} \hat{a}'(x_1 + x_2) $$

---

# 5. 分类性能评估

## 误分类总概率（TPM）
$$ TPM = P_1 \int_{R_2} f_1(x)dx + P_2 \int_{R_1} f_2(x)dx $$

## 实际误差率（AER）
- 通过估计概率密度函数参数计算：
$$ AER = P_1 \int_{R_2} f_1(x)dx + P_2 \int_{R_1} f_2(x)dx $$

---

# 6. 交叉验证方法

## Jackknife 方法
1. 对每个观测逐一移除。
2. 用剩余样本构建分类器并评估误分类概率。

## 条件误分类概率
$$ P(2|1) = \frac{n_{1m}(H)}{n_1}, \quad P(1|2) = \frac{n_{2m}(H)}{n_2} $$

## 平均误差估计
$$ \hat{E}\{AER\} = \frac{n_{1m}(H) + n_{2m}(H)}{n_1 + n_2} $$

---

# 7. 多个总体的分类

## 条件期望误分类成本
$$ ECM(i) = \sum_{k \neq i} P(k|i)c(k|i) $$

## 总体误分类成本
$$ ECM = \sum_{i=1}^{g} p_i ECM(i) $$
